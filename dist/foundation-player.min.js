(function(){var t=[].slice;!function(e,r){"use strict";var n;return n=function(){function t(t,r){this.options=e.extend({},this.defaults,r),this.$wrapper=e(t),this.$player=this.$wrapper.children(".player"),this.$play=this.$wrapper.find(".player-button.play em"),this.$rewind=this.$wrapper.find(".player-button.rewind em"),this.$volume=this.$wrapper.find(".player-button.volume em"),this.$elapsed=this.$wrapper.find(".player-status.time .elapsed"),this.$remains=this.$wrapper.find(".player-status.time .remains"),this.$progress=this.$wrapper.find(".player-progress .progress"),this.$played=this.$progress.find(".meter.played"),this.$sources=this.$wrapper.children("audio"),this.audio=this.$sources.get(0),this.played=0,this.nowdragging=!1,this.currentUISize=this.options.size,this.canPlayCurrent=!1,this.resetClassAndStyle(),this.setUpCurrentAudio(),this.setUpButtonPlayPause(),this.setUpButtonVolume(),this.setUpButtonRewind(),this.setUpPlayedProgress(),this.options.useSeekData&&this.parseDataLinks()}var n,i,s,o,a;return t.prototype.defaults={size:"normal",playOnLoad:!1,skipSeconds:10,dimmedVolume:.25,pauseOthersOnPlay:!0,useSeekData:!1,seekDataClass:"seek-to"},t.prototype.playPause=function(){return this.audio.paused?this.play():this.pause()},t.prototype.play=function(){return this.options.pauseOthersOnPlay&&this.getPlayerInstances().map(function(t){return function(e){return t!==e?e.pause():void 0}}(this)),this.audio.play(),this.updateButtonPlay()},t.prototype.pause=function(){return this.audio.pause(),this.updateButtonPlay()},t.prototype.seekToTime=function(t){return this.audio.currentTime=i(t),this.updatePlayedProgress(),this.updateTimeStatuses(),this},t.prototype.seekPercent=function(t){return this.audio.currentTime=this.audio.duration*(t>=1?t/100:t),this.updatePlayedProgress(),this.updateTimeStatuses(),this},t.prototype.resetClassAndStyle=function(){return this.$wrapper.addClass(this.options.size),this.setPlayerSizeHandler()},t.prototype.setUpCurrentAudio=function(){var t;return this.audio.load(),t=e(this.audio),t.on("timeupdate.fndtn.player",function(t){return function(){return t.updatePlayedProgress(),t.updateTimeStatuses()}}(this)),t.on("loadstart.fndtn.player",function(t){return function(){return t.canPlayCurrent=!1,t.updateDisabledStatus(),t.updateButtonPlay()}}(this)),t.on("durationchange.fndtn.player",function(t){return function(){return t.updateTimeStatuses()}}(this)),t.on("progress.fndtn.player",function(t){return function(){return t.redrawBufferizationBars(),t.updateDisabledStatus()}}(this)),t.on("canplay.fndtn.player",function(t){return function(){return t.canPlayCurrent=!0,t.options.playOnLoad&&t.play(),t.redrawBufferizationBars(),t.updateDisabledStatus(),t.updateButtonPlay()}}(this))},t.prototype.setUpButtonPlayPause=function(){return this.$play.bind("click",function(t){return function(){return t.canPlayCurrent?t.playPause():void 0}}(this))},t.prototype.updateButtonPlay=function(){return this.$play.toggleClass("fi-music",!this.canPlayCurrent),this.$play.toggleClass("fi-pause",this.audio.paused&&this.canPlayCurrent),this.$play.toggleClass("fi-play",!this.audio.paused),this},t.prototype.setUpButtonVolume=function(){return this.$volume.bind("click.fndtn.player",function(t){return function(){return t.buttonVolumeHandler()}}(this))},t.prototype.updateButtonVolume=function(){return this.audio.muted?a(this.$volume,"fi-volume-strike","fi-volume"):a(this.$volume,"fi-volume","fi-volume-strike")},t.prototype.buttonVolumeHandler=function(){return this.toggleMute(),this.updateButtonVolume()},t.prototype.setUpButtonRewind=function(){return this.$rewind.on("click",function(t){return function(){return t.seekToTime(t.audio.currentTime-t.options.skipSeconds)}}(this))},t.prototype.setUpPlayedProgress=function(){var t;return this.$played.css("width",this.played+"%"),this.$progress.on("click.fndtn.player",function(t){return function(e){return t.seekPercent(Math.floor(e.offsetX/t.$progress.outerWidth()*100))}}(this)),this.$progress.on("mousedown.fndtn.player",function(t){return function(){return t.nowdragging=!0,t.setVolume(t.options.dimmedVolume)}}(this)),t=function(t){return function(){return t.nowdragging?(t.nowdragging=!1,t.setVolume(1)):void 0}}(this),this.$player.on("mouseleave.fndtn.player",function(){return t()}),e(document).on("mouseup.fndtn.player",function(){return t()}),e(r).on("blur.fndtn.player",function(){return t()}),this.$progress.on("mousemove.fndtn.player",function(t){return function(e){return t.nowdragging?t.seekPercent(Math.floor(e.offsetX/t.$progress.outerWidth()*100)):void 0}}(this))},t.prototype.updatePlayedProgress=function(){return this.played=Math.round(this.audio.currentTime/this.audio.duration*100),this.$played.css("width",this.played+"%")},t.prototype.redrawBufferizationBars=function(){var t,e,r,n,i,s,o,u,p,d,l,h;if(this.$progress.find(".buffered").remove(),p=this.audio.buffered.length,p>0){for(d=parseInt(this.$progress.css("padding-top"),10),i=parseInt(this.$progress.css("padding-left"),10),l=this.$progress.width(),r=this.$progress.height(),h=2*parseInt(this.$played.css("padding-left"),10),u=[],s=n=0,o=p;o>=0?o>n:n>o;s=o>=0?++n:--n)t=this.audio.buffered.start(s),e=this.audio.buffered.end(s),u.push(a(this.$played.clone(),"buffered","played").css("left",i+Math.floor(l*(t/this.audio.duration))+"px").css("top",d).height(r).width(Math.floor(l*(e-t)/this.audio.duration)).appendTo(this.$progress));return u}},t.prototype.setVolume=function(t){return this.audio.volume=t},t.prototype.toggleMute=function(){return this.audio.muted=!this.audio.muted},t.prototype.updateTimeStatuses=function(){return this.updateStatusElapsed(),this.updateStatusRemains()},t.prototype.updateStatusElapsed=function(){return this.$elapsed.text(s(this.audio.currentTime))},t.prototype.updateStatusRemains=function(){return this.$remains.text("-"+s(this.audio.duration-this.audio.currentTime))},t.prototype.updateDisabledStatus=function(){return this.$player.toggleClass("disabled",!this.canPlayCurrent)},t.prototype.togglePlayerSize=function(){var t;return t="normal"===this.currentUISize?"small":"normal",this.setPlayerSize(t)?this.currentUISize=t:void 0},t.prototype.setPlayerSize=function(t){return"normal"!==t&&"small"!==t||t===this.currentUISize?!1:(a(this.$wrapper,t,this.currentUISize),this.setPlayerSizeHandler(),this.currentUISize=t)},t.prototype.setPlayerSizeHandler=function(){return this.playerBeautifyProgressBar(),this.redrawBufferizationBars()},t.prototype.playerBeautifyProgressBar=function(){var t;return this.$progress.hasClass("round")?(t=this.$played.height()/2,this.$played.css("padding","0 "+t+"px"),this.$progress.find(".buffered").css("padding","0 "+t+"px")):void 0},t.prototype.getPlayerInstances=function(){return e.data(document.body,"FoundationPlayers")},t.prototype.parseDataLinks=function(){return!1},a=function(t,r,n){return e(t).addClass(r).removeClass(n)},s=function(t){var e,r;return n(t)?(e=Math.floor(t/60),r=Math.floor(t-60*e),o(e,"0",2)+":"+o(r,"0",2)):!1},o=function(t,e,r){return(new Array(r+1).join(e)+t).slice(-r)},n=function(t){return"number"==typeof t&&isFinite(t)},i=function(t){var e;return n(t)?t:(e=t.match(/^(\d{1,})$/))?e[1]:(e=t.match(/^(\d?\d):(\d\d)$/))?60*parseInt(e[1],10)+parseInt(e[2],10):!1},t}(),e.fn.extend({foundationPlayer:function(){var r,i;return i=arguments[0],r=2<=arguments.length?t.call(arguments,1):[],e.data(document.body,"FoundationPlayers")||e.data(document.body,"FoundationPlayers",[]),this.each(function(){var t;return e.data(this,"FoundationPlayer")?void 0:(t=new n(this,i),e.data(this,"FoundationPlayer",t),e.data(document.body,"FoundationPlayers").push(t))})}})}(window.jQuery,window)}).call(this);